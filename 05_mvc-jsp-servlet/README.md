# 05_mvc-jsp-servlet

[Jest też dostępna polska wersja tutaj](README.pl.md)

Simple portlet showing combiining jsp technology with servlet controller

## Exercises
*Exercise 05:*
1. Create model for animal:
```
Animal {
    String id; (autogenerated value during object creation)
    enum Species {FISH, MAMMALS, REPTILE, INSECT, BIRD, AMPHIBIAN}
    String name;
    int age;
    String pictureUrl;
    String description;
}
```
2. Create `Map<Integer, Animal>` storing some animals, where key is their id. This will mock your datasource.
3. Implement view of servlet allowing you to see all animals (you can use table, list or anything you like)
Here is example of this view:

| Name            | Age           |Species  |
| ----------------|:-------------:| -------:|
| Cat Sylvester   |12             | Mammal  |
| Doge            |1              | Mammal  |
| Turtle Leonardo |101            | Reptile |

4. Implement details view, allowing you to see details of animal
- Id: 1
- Name: Cat Sylvester
- Age: 12
- Species Mammal
![some pretty picture of cat](http://images5.fanpop.com/image/photos/30900000/Sylvester-the-Cat-warner-brothers-animation-30976217-250-262.jpg "some pretty picture of cat")
```
Sylvester J. Pussycat Sr., usually called Sylvester, is a fictional character,
a three-time Academy Award-winning anthropomorphic, 40, 50, or 60-Inch tall Tuxedo
cat in the Looney Tunes and Merrie Melodies series of cartoons.[1] Most of his appearances
have him often chasing Tweety Bird, Speedy Gonzales, or Hippety Hopper. The name "Sylvester"
is a play on Felis silvestris, the scientific name for the wild cat species (domestic cats
like Sylvester, though, are actually Felis catus). The character debuted in Friz Freleng's
Life With Feathers (1945), but Freleng's 1947 cartoon Tweetie Pie was the first pairing
of Tweety with Sylvester, and the Bob Clampett-directed Kitty Kornered (1946) was Sylvester's
first pairing with Porky Pig. Sylvester was not named until Chuck Jones gave him the name
Sylvester, which was first used in Scaredy Cat.[citation needed] Sylvester appeared in 103
cartoons in the golden age, appearing in the fourth most films out of all the Looney Tunes/Merrie
Melodies characters, only behind Bugs Bunny, Porky Pig, and Daffy Duck respectively. Three of his
cartoons won Academy Awards, the most for any starring Looney Tunes character: they are Tweetie Pie,
Speedy Gonzales, and Birds Anonymous.
```
5. Next step is preparing form allowing you to add new animals to Map<Integer, Animal> representing you database.
- for this purpose you will need create form with POST action and implement logic in doPost method of your servlet
6. Implement feature allowing you to delete animals, and include url which allows you to POST request.
7. Implement feature allowing you to edit given animal and save results.
- think of reusing existing form you created for creation new animal purposes
## Congratulations you completed your first CRUD project :-) Think of your own ideas you can implement using the same techniques you learned so far.
8. Add more animals to your Map<Integer, Animal> like 20, then prepare form above your list, so you can filter your animals by name, species and age.
- Use get method so you can save your url.
9. Think of implementing pagination feature for your list like following example:
```
?page=1&delta=20
```
- page - represents page of elements returned
- delta - represents how many elements you want to display on each page



## How to Servlet CRUD
1. Add packages to your project splitting model layer from controller/service layer.
      ```
      foo
      └── bar
          └── yourdomain
              ├── controller
              ├── model
              └── service
      ```
2. Implement simple routing in `YourServlet.java` and put it in your controller package
    - `/` -> `list.jsp`
    - `/details` -> `details.jsp`
    - `/add` -> `form.jsp`
   To each page add section with simple header naming current view:
   ```
   <h1> Welcome on list.jsp</h1>
   <h1> Welcome on details.jsp</h1>
   ...
   ``` 
3. Add model class to your project `YourModel.java` to `foo.bar.yourdomain.model` package   
4. Create `YourService.java` storing static `List<YourModel> YOUR_MODELS`
5. Fill `YOUR_MODELS` list with some example objects.
6. Implement method in `YourService.java` called `List<YourModel> findAll()` allowing you to return whole `YOUR_MODEL` list
   - in the future we can exachange this part with some data access part.
7. Try to use `YourService.findAll()` method in `YourServlet.java` and pass it to view as below:
 ```
 request.setAttribute("yourList", yourService.findAll());
 ```
8. Add following code to see if we get correct size of list on view:
```
<h3>${yourList.size()}</h3>
```
9. Implement presenting list of objects in `list.jsp` using JSTL tags (check examples in `jsp-example` repository) 
- remember to add dependency to your `pom.xml`:
```
<dependency>
  <groupId>jstl</groupId>
  <artifactId>jstl</artifactId>
  <version>1.2</version>
</dependency>
```
10. Add auto generated id to your `YouModel.java` constructor to mark each object distinct id:
```
UUID.randomUUID().toString()
```
or implement simple counter to add next id each time new object is created.
```
static Integer CURRENT_INDEX = 1;
```
Now in YourModel(...) constructor class use `CURRENT_INDEX` value and increment it for next object `++`

11. Try to implement request param handling in your `doGet(...)` method in `YourServlet.java` class.
Check out example `03_get-post-servlet` how to do this.
12. Implement `YourModel findOne(String id)` method in `YourService.java` class returning object with requested id.
13. Pass following object to `details.jsp` view and try to display name of this object.
14. Create html form allowing you to pass name of the new object (as the reference use post example from jsp-exmples repository)
15. Implement `doPost` method which creates new instance of `YourModel` and pass it to new method `add(YourModel newModel)` in `YourService` class.
16. In the end of doPost method, you can redirect to `/` list view (use `03_get-post-servlet` as reference)
